rule TrojanGeneric
{
    meta:
        description = "Generic trojan detection"
        author = "AegisAI"
        date = "2025-10-20"
        threat_level = 4
        version = "2.0"
    
    strings:
        $mz = "MZ"
        $trojan1 = "CreateRemoteThread" ascii nocase
        $trojan2 = "WriteProcessMemory" ascii nocase
        $trojan3 = "VirtualAlloc" ascii nocase
        $trojan4 = "SetWindowsHookEx" ascii nocase
        $trojan5 = "AdjustTokenPrivileges" ascii nocase
        $inject1 = "inject" ascii nocase
        $dll1 = "LoadLibrary" ascii nocase
        $dll2 = "GetProcAddress" ascii nocase
        $process1 = "CreateProcess" ascii nocase
        $process2 = "OpenProcess" ascii nocase
        $registry1 = "RegSetValue" ascii nocase
        $registry2 = "RegCreateKey" ascii nocase
        $file1 = "CreateFile" ascii nocase
        $file2 = "DeleteFile" ascii nocase
        $memory1 = "VirtualProtect" ascii nocase
        $memory2 = "ReadProcessMemory" ascii nocase
        
    condition:
        $mz at 0 and
        4 of ($trojan*, $inject*, $dll*, $process*, $registry*, $file*, $memory*) and
        filesize < 2000KB
}

rule RansomwareGeneric
{
    meta:
        description = "Generic ransomware detection"
        author = "AegisAI"
        date = "2025-10-20"
        threat_level = 5
        version = "2.0"
    
    strings:
        $mz = "MZ"
        $crypto1 = "CryptEncrypt" ascii nocase
        $crypto2 = "CryptDecrypt" ascii nocase
        $crypto3 = "CryptAcquireContext" ascii nocase
        $key1 = "publickey" ascii nocase
        $key2 = "privatekey" ascii nocase
        $encrypt1 = "encrypt" ascii nocase
        $decrypt1 = "decrypt" ascii nocase
        $bitcoin1 = "bitcoin" ascii nocase
        $wallet1 = "wallet" ascii nocase
        $rsa1 = "RSA" ascii nocase
        $aes1 = "AES" ascii nocase
        $crypt1 = "crypt" ascii nocase
        $lock1 = "lock" ascii nocase
        $locked1 = "locked" ascii nocase
        $pay1 = "pay" ascii nocase
        $payment1 = "payment" ascii nocase
        $note1 = "readme" ascii nocase
        $note2 = "instructions" ascii nocase
        
    condition:
        $mz at 0 and
        4 of ($crypto*, $key*, $encrypt*, $decrypt*, $bitcoin*, $wallet*, $rsa*, $aes*, $crypt*, $lock*, $pay*, $note*) and
        filesize < 5000KB
}

rule WormGeneric
{
    meta:
        description = "Generic worm detection"
        author = "AegisAI"
        date = "2025-10-20"
        threat_level = 3
        version = "2.0"
    
    strings:
        $mz = "MZ"
        $network1 = "WSAStartup" ascii nocase
        $network2 = "connect" ascii nocase
        $network3 = "send" ascii nocase
        $network4 = "recv" ascii nocase
        $network5 = "socket" ascii nocase
        $spread1 = "NetShareEnum" ascii nocase
        $spread2 = "WNetAddConnection" ascii nocase
        $spread3 = "replicate" ascii nocase
        $network6 = "bind" ascii nocase
        $network7 = "listen" ascii nocase
        $network8 = "accept" ascii nocase
        $network9 = "inet_addr" ascii nocase
        $network10 = "htons" ascii nocase
        $spread4 = "CopyFile" ascii nocase
        $spread5 = "CreateFile" ascii nocase
        $spread6 = "WriteFile" ascii nocase
        
    condition:
        $mz at 0 and
        4 of ($network*, $spread*) and
        filesize < 3000KB
}

rule AdwareGeneric
{
    meta:
        description = "Generic adware detection"
        author = "AegisAI"
        date = "2025-10-20"
        threat_level = 2
        version = "2.0"
    
    strings:
        $mz = "MZ"
        $ad1 = "advert" ascii nocase
        $ad2 = "banner" ascii nocase
        $ad3 = "popup" ascii nocase
        $tracking1 = "track" ascii nocase
        $tracking2 = "analytics" ascii nocase
        $browser1 = "browser" ascii nocase
        $toolbar1 = "toolbar" ascii nocase
        $ad4 = "adserver" ascii nocase
        $ad5 = "adsense" ascii nocase
        $tracking3 = "pixel" ascii nocase
        $tracking4 = "beacon" ascii nocase
        $tracking5 = "telemetry" ascii nocase
        $browser2 = "extension" ascii nocase
        $browser3 = "plugin" ascii nocase
        $popup1 = "window.open" ascii nocase
        $popup2 = "showModalDialog" ascii nocase
        
    condition:
        $mz at 0 and
        3 of ($ad*, $tracking*, $browser*, $toolbar*, $popup*) and
        filesize < 1000KB
}

rule RootkitGeneric
{
    meta:
        description = "Generic rootkit detection"
        author = "AegisAI"
        date = "2025-10-20"
        threat_level = 5
        version = "1.0"
    
    strings:
        $mz = "MZ"
        $kernel1 = " ZwSetSystemInformation" ascii nocase
        $kernel2 = "ZwQuerySystemInformation" ascii nocase
        $kernel3 = "KeInsertQueueApc" ascii nocase
        $kernel4 = "MmCreateMdl" ascii nocase
        $kernel5 = "PsSetCreateProcessNotifyRoutine" ascii nocase
        $driver1 = "DriverEntry" ascii nocase
        $driver2 = "IoCreateDevice" ascii nocase
        $driver3 = "IoCreateSymbolicLink" ascii nocase
        $hook1 = "InlineHook" ascii nocase
        $hook2 = "IAThook" ascii nocase
        $ssdt1 = "SSDT" ascii nocase
        $ssdt2 = "KeServiceDescriptorTable" ascii nocase
        $hide1 = "hide" ascii nocase
        $hide2 = "stealth" ascii nocase
        $processhide1 = "ProcessHide" ascii nocase
        $filehide1 = "FileHide" ascii nocase
        
    condition:
        $mz at 0 and
        3 of ($kernel*, $driver*, $hook*, $ssdt*, $hide*, $processhide*, $filehide*) and
        filesize < 4000KB
}

rule KeyloggerGeneric
{
    meta:
        description = "Generic keylogger detection"
        author = "AegisAI"
        date = "2025-10-20"
        threat_level = 4
        version = "1.0"
    
    strings:
        $mz = "MZ"
        $key1 = "GetAsyncKeyState" ascii nocase
        $key2 = "GetKeyboardState" ascii nocase
        $key3 = "GetKeyState" ascii nocase
        $hook1 = "SetWindowsHookEx" ascii nocase
        $hook2 = "CallNextHookEx" ascii nocase
        $log1 = "log" ascii nocase
        $log2 = "record" ascii nocase
        $file1 = "CreateFile" ascii nocase
        $file2 = "WriteFile" ascii nocase
        $send1 = "send" ascii nocase
        $send2 = "WSAStartup" ascii nocase
        $clipboard1 = "GetClipboardData" ascii nocase
        $clipboard2 = "SetClipboardViewer" ascii nocase
        $screenshot1 = "BitBlt" ascii nocase
        $screenshot2 = "PrintWindow" ascii nocase
        
    condition:
        $mz at 0 and
        4 of ($key*, $hook*, $log*, $file*, $send*, $clipboard*, $screenshot*) and
        filesize < 1500KB
}